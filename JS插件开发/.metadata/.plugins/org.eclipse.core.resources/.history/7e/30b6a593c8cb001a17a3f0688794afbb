
(function () {
	GeoBOS.filesystem.init(function(err){
		if (err) {
			console.log(err.message);
		} else {
			document.getElementById("current_path").value = arguments[1];
			var div_display_folder = document.getElementById("div_display_folder");
			for(var i = 2; i < arguments.length; i++) {
				var temp_ul = document.createElement("ul");
				temp_ul.innerHTML = arguments[i];
				temp_ul.onclick = openFileOrFolderByName();
				div_display_folder.appendChild(temp_ul);
			}
		}
	});
})();

var current_dispaly_status = "div_display_folder";

function openFileOrFolderByName() {
	GeoBOS.filesystem.openFileOrFolderByName(this.innerHTML, function(err){
		if(err) {
			console.log(err.message);
		} else {
			if(arguments[1] == "folder") {
				setDivDisplayFolder();
				document.getElementById("current_path").value = arguments[2];
				var div_display_folder = document.getElementById("div_display_folder");
				div_display_folder.innerHTML = "";
				for(var i = 3; i < arguments.length; i++) {
					var temp_ul = document.createElement("ul");
					temp_ul.innerHTML = arguments[i];
					temp_ul.onclick = openFileOrFolderByName;
					div_display_folder.appendChild(temp_ul);
				}
			} else if(arguments[1] == "file") {
				setDivDisplayFile();
			}
		}
	});
}

function onOpen() {
	GeoBOS.filesystem.openFileOrFolderByPath(this.value, function(err){
		if (err) {
			console.log(err.message);
		} else {
			if(arguments[1] == "folder") {
				setDivDisplayFolder();
				document.getElementById("current_path").value = arguments[2];
				var div_display_folder = document.getElementById("div_display_folder");
				div_dispaly_folder.innerHTML = "";
				for(var i = 3; i < arguments.length; i++) {
					var temp_ul = document.createElement("ul");
					temp_ul.innerHTML = arguments[i];
					temp_ul.onclick = openFileOrFolderByName;
					div_display.appendChild(temp_ul);
				}
			} else if(arguments[1] == "file") {
				setDivDisplayFile();
			}
		}
	});
}


function onReturn() {
	
	if(current_dispaly_status != "div_display_folder"){
		
		setDivDisplayFolder();
		return;
	}
	GeoBOS.filesystem.returnPreFolder(function(err){
		if (err) {
			console.log(err.message);
		} else {
			document.getElementById("current_path").value = arguments[1];
			var div_display = document.getElementById("div_display");
			div_display.innerHTML = "";
			for(var i = 2; i < arguments.length; i++) {
				var temp_ul = document.createElement("ul");
				temp_ul.innerHTML = arguments[i];
				temp_ul.onclick = openFileOrFolderByName;
				div_display.appendChild(temp_ul);
			}
		}
	});
}


//界面的切换

//设置三种显示界面

function onSearch() {
	
}

function setDivDisplayFolder() {
	
	document.getElementById(current_dispaly_status).display = "none";
	current_dispaly_status = "div_dispaly_folder";
	document.getElementById(current_dispaly_status).display = "inline";
	document.getElementById("button_open").disabled = "true";
	document.getElementById("button_search").disabled = "true";
	document.getElementById("button_return").disabled = "true";
}

function setDivDisplayFile() {
	
	document.getElementById(current_dispaly_status).display = "none";
	current_dispaly_status = "div_dispaly_file";
	document.getElementById(current_dispaly_status).display = "inline";
	document.getElementById("button_open").disabled = "false";
	document.getElementById("button_search").disabled = "false";
	document.getElementById("button_return").disabled = "true";
}

function setDivDisplaySearchResult() {
	
	document.getElementById(current_dispaly_status).display = "none";
	current_dispaly_status = "div_dispaly_search_result";
	document.getElementById(current_dispaly_status).display = "inline";
	document.getElementById("button_open").disabled = "false";
	document.getElementById("button_search").disabled = "true";
	document.getElementById("button_return").disabled = "true";
}
